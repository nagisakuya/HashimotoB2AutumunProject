using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
//以下、OpenCvsharpの使用とMatの変換用として追加
using OpenCvSharp;
using OpenCvSharp.Extensions;
using Point = OpenCvSharp.Point;

using System.Numerics;
using MathNet.Numerics;
using MathNet.Numerics.IntegralTransforms;
using System.IO.Ports;

using static Library.Processor;

namespace HashimotoB2Autumun
{
    public partial class Form1 : Form
    {

        private Mat _flame;
        readonly private static Complex[] book = new Complex[] { new Complex(0.106303438965343, -0.487783311451621), new Complex(0.356644113464688, 0.0224686623241606), new Complex(-0.154427361638968, -0.0960982084966552), new Complex(-0.0960321196203236, 0.187510635995597), new Complex(-0.0870435500975158, 0.0799764958011824), new Complex(-0.0343777004004697, -0.00745977257261031), new Complex(0.0165998402993892, 0.0195033060650461), new Complex(-0.00261288654043604, -0.00909962778957753), new Complex(-0.00295651260701873, -0.000931854349652757), new Complex(-0.00111404121043307, 0.00457898011810432), new Complex(-0.0079004516938434, 0.00788495489998601), new Complex(-0.00929899352726277, 0.00648561847080422), new Complex(-0.00742669927897807, 0.00467590246986156), new Complex(0.00483380346674073, 0.00412486833433335), new Complex(-0.00415437811738627, -0.00534547609048459), new Complex(-0.000166537128210122, 0.0051681074308458), new Complex(-0.00339717917035419, 0.00252325421447125), new Complex(-0.00140539762514397, -0.000608011547482193), new Complex(-0.00260395799273773, 0.00298837952772283), new Complex(-0.00108383536727405, 0.00203879707424952), new Complex(0.000141665475508116, -8.30773529292801E-05), new Complex(-0.000434312988126565, -0.00112687075533646), new Complex(-0.00175063946906915, 0.0039566262444828), new Complex(-0.00278115300848442, 0.00114548296674108), new Complex(-0.00234603616663011, 0.000717531188143548), new Complex(0.000864905687902159, 0.00196969443792378), new Complex(-0.00114509689272743, -0.00120027239204869), new Complex(0.0010347204747003, 0.000367153460330568), new Complex(-0.00037627380438956, 0.000163908609815132), new Complex(-0.000747930115345053, 0.00123720014413498), new Complex(-0.00351040669218224, 0.00179312862104152), new Complex(-0.0021799115762266, 0.00258200614991458), new Complex(0.000391984176528109, 0.000543057848379773), new Complex(-0.000268493966296257, -0.00210837065287414), new Complex(0.00106703056387038, 0.00174481911173371), new Complex(-1.4109500106385E-05, -0.000946773661423055), new Complex(-0.000267630579308204, -7.1042289801013E-05), new Complex(-0.00290618631675187, 0.00282244216767887), new Complex(-0.00290618631675259, 0.00282244216767888), new Complex(-0.000267630579308956, -7.10422897998625E-05), new Complex(-1.41095001072433E-05, -0.000946773661422324), new Complex(0.00106703056387, 0.00174481911173385), new Complex(-0.000268493966295982, -0.00210837065287382), new Complex(0.000391984176527601, 0.000543057848379431), new Complex(-0.00217991157622628, 0.00258200614991507), new Complex(-0.00351040669218247, 0.00179312862104087), new Complex(-0.000747930115344451, 0.0012372001441351), new Complex(-0.000376273804389836, 0.000163908609814938), new Complex(0.00103472047469991, 0.000367153460331078), new Complex(-0.00114509689272786, -0.00120027239204831), new Complex(0.00086490568790228, 0.00196969443792361), new Complex(-0.00234603616662952, 0.000717531188142879), new Complex(-0.00278115300848376, 0.00114548296674066), new Complex(-0.00175063946906922, 0.0039566262444825), new Complex(-0.000434312988126697, -0.00112687075533604), new Complex(0.000141665475507608, -8.30773529289851E-05), new Complex(-0.00108383536727441, 0.00203879707424982), new Complex(-0.00260395799273783, 0.00298837952772286), new Complex(-0.00140539762514403, -0.000608011547482267), new Complex(-0.00339717917035418, 0.00252325421447109), new Complex(-0.000166537128209882, 0.00516810743084549), new Complex(-0.00415437811738566, -0.00534547609048506), new Complex(0.00483380346674094, 0.00412486833433286), new Complex(-0.00742669927897762, 0.00467590246986137), new Complex(-0.00929899352726291, 0.00648561847080346), new Complex(-0.0079004516938431, 0.00788495489998571), new Complex(-0.00111404121043321, 0.00457898011810429), new Complex(-0.00295651260701928, -0.000931854349652742), new Complex(-0.00261288654043619, -0.00909962778957663), new Complex(0.0165998402993876, 0.0195033060650471), new Complex(-0.0343777004004703, -0.00745977257261009), new Complex(-0.0870435500975173, 0.0799764958011804), new Complex(-0.0960321196203243, 0.187510635995592), new Complex(-0.154427361638958, -0.0960982084966647), new Complex(0.356644113464691, 0.0224686623241691), };
        readonly private static Complex[] rotation_panel = new Complex[] { new Complex(0.0133278852857546, 0.811575271897144), new Complex(-0.103033524609092, -0.190778572428629), new Complex(-0.248960047670429, 0.155867683317974), new Complex(0.011494180664117, -0.363410946532111), new Complex(0.170978666438979, -0.0513549736724517), new Complex(0.0594630618398272, 0.0463551719184882), new Complex(0.0122945520296847, 0.00048196591744024), new Complex(0.0404539625532526, -0.0180346866333705), new Complex(0.0353130980421123, -0.00267669681148917), new Complex(0.00990556813968571, -0.00165362141971049), new Complex(0.00103323730153073, 0.0144021228703707), new Complex(-0.00526420559001902, -0.000234900748010043), new Complex(0.0063122683752315, -0.0074956677152936), new Complex(0.00448645149865201, -0.00131259908877669), new Complex(-0.00941310613508054, 0.00894339598666502), new Complex(-0.00185816175866953, -0.00837271600900852), new Complex(0.00572433865228018, 0.00608451122326456), new Complex(-0.00137533179714052, 0.00279864710960228), new Complex(-0.00401238416834534, 0.00215011789604407), new Complex(0.00127889484456217, -0.00230242453214135), new Complex(0.00090254652706038, 0.00395205864945091), new Complex(-0.00165397229782231, 0.000695139528243321), new Complex(0.0018302935708376, 0.00375538421493391), new Complex(0.00424729395945672, -0.00122958488544049), new Complex(0.00168824726719337, -0.00439424605789202), new Complex(-0.00117105115882634, 0.000790189124908961), new Complex(-0.000845325832517473, 0.000672184169242573), new Complex(0.000234441575411388, -0.00370742187316476), new Complex(0.00156534394192242, -0.0020203149540577), new Complex(-0.00115842617110147, 0.00103257247849094), new Complex(-0.00323106311429961, 0.00427169559316654), new Complex(0.000261725036055278, -0.00167988679937218), new Complex(0.00124131476477946, 0.00252106832484068), new Complex(-0.000964245116843347, 0.000154962543839528), new Complex(-0.000266283982508699, 0.00285278021801121), new Complex(0.000339231509012245, 0.00105830616646179), new Complex(-0.00130659376697623, -0.00516856298304797), new Complex(-0.0025366132490839, 0.00137311546794135), new Complex(-0.00109110790944226, 0.00154176962780839), new Complex(0.0017469146603918, -0.00029201648646727), new Complex(0.00226880418947732, 0.00169466673879201), new Complex(0.000266451419360229, -0.000264129506574725), new Complex(-0.000183410744744471, 0.00354135492950197), new Complex(0.000769056350817001, -0.00127593394017967), new Complex(0.000323743606107468, -0.00171612377904779), new Complex(-0.00078656675838728, -0.00177237404604577), new Complex(0.00067200154291286, 0.000303415615537348), new Complex(0.00120010091324133, -0.00116380053338114), new Complex(0.00203326690260343, -0.00213961108944719), new Complex(0.0042142070322076, 0.00071568984917806), new Complex(0.0025327401076462, 0.000595015907781966), new Complex(0.000106107689514595, 0.000102298660224589), new Complex(0.000846906886664742, -0.00262563683667329), new Complex(0.00075240513880951, 0.00172954487343427), new Complex(-0.00116370354102871, 0.000286238730421332), new Complex(0.00183802454273954, 0.00155911525636648), new Complex(0.0036873629361214, -0.00237924947960253), new Complex(-0.000435815155000632, 5.41091546643028E-05), new Complex(-0.00233871976481121, 0.00126758994052316), new Complex(0.00016689421551052, -0.000919375269166376), new Complex(0.000821237069592568, -0.000505536603993843), new Complex(0.00102018462926628, -0.00193007712258688), new Complex(0.000709000316911147, 0.00141204652061434), new Complex(-0.00214449386595189, 0.00148037118026349), new Complex(-0.00211367094540916, -0.00100329149136837), new Complex(0.000460321252810528, 0.000393738598020371), new Complex(0.000390258069476403, 0.000791210223571639), new Complex(-0.00111989663900956, 0.00102052995725181), new Complex(-7.25749713830307E-05, 0.000893143496236868), new Complex(-0.000175934161096559, 3.81926209775315E-06), new Complex(-0.00131634450991687, -0.000787413339122803), new Complex(0.000132286139869994, 0.00102039914534902), new Complex(-0.000285887588516833, -0.00194085289904219), new Complex(-0.00155601625163076, 0.000523998790792762), new Complex(0.000330042741247231, 0.00110880295331202), new Complex(0.00149521444257418, -0.00066460514912092), new Complex(-0.000378372765527595, -0.000868467535200229), new Complex(0.000620864112680886, 0.000915059007532434), new Complex(0.0011278251367906, -0.00102881393930729), new Complex(-0.00059319605243758, 0.00205922196079953), new Complex(0.000579076882450906, -0.00228882758361824), new Complex(0.00137382876998353, -0.0017249213621648), new Complex(-0.00107459168838367, 0.00102198365296709), new Complex(-0.00136463748343828, -0.00160452596748898), new Complex(0.000622427737942012, 0.000550815179085291), new Complex(0.000491300952120607, -0.000109019643584239), new Complex(-0.000807387972239962, 0.000178958570843818), new Complex(-0.00110783158408206, 0.00153705313649959), new Complex(-0.000629757193248001, 0.000966940814092225), new Complex(-0.000416847462398868, 0.00081150906131933), new Complex(-0.000889054588813453, 0.0002068980495638), new Complex(-0.00089138855389244, 0.00104939591295172), new Complex(-0.000219622851092512, -0.00157275763788118), new Complex(-0.00060215555593408, 7.12199823074738E-05), new Complex(-0.00134700903271399, -0.000975068017419135), new Complex(-0.00015787899336251, 0.00115548088272377), new Complex(0.00165999531744561, 4.58616508379524E-05), new Complex(0.00121318323940118, -0.00153004048116626), new Complex(-0.00149391896672436, 0.000587665726318507), new Complex(-0.0016175463594543, 0.000240641011048906), new Complex(0.000626309592149671, 0.00141343974706268), new Complex(0.0011164376007106, -0.00183247484494015), new Complex(0.000471488539959067, -0.000983160056702247), new Complex(7.9145265143609E-05, 0.00242763781463301), new Complex(-0.000260318264170291, 3.10821504497392E-05), new Complex(-0.000792082524165438, -0.00158451460547676), new Complex(-0.000792082524165312, -0.0015845146054753), new Complex(-0.000260318264170531, 3.10821504504392E-05), new Complex(7.91452651420918E-05, 0.00242763781463499), new Complex(0.000471488539957453, -0.000983160056702629), new Complex(0.00111643760071046, -0.00183247484493923), new Complex(0.000626309592150238, 0.00141343974706172), new Complex(-0.00161754635945484, 0.000240641011048569), new Complex(-0.001493918966725, 0.000587665726317003), new Complex(0.00121318323940168, -0.00153004048116449), new Complex(0.00165999531744597, 4.58616508374302E-05), new Complex(-0.000157878993363364, 0.00115548088272596), new Complex(-0.00134700903271445, -0.000975068017420807), new Complex(-0.000602155555933306, 7.12199823091751E-05), new Complex(-0.000219622851090912, -0.00157275763788285), new Complex(-0.000891388553891663, 0.0010493959129515), new Complex(-0.000889054588813363, 0.000206898049561085), new Complex(-0.000416847462398635, 0.00081150906131978), new Complex(-0.00062975719324756, 0.000966940814092794), new Complex(-0.00110783158408252, 0.00153705313650164), new Complex(-0.000807387972241163, 0.000178958570843645), new Complex(0.000491300952119837, -0.000109019643583637), new Complex(0.00062242773794226, 0.000550815179084312), new Complex(-0.00136463748343795, -0.00160452596748806), new Complex(-0.00107459168838358, 0.00102198365296526), new Complex(0.00137382876998318, -0.0017249213621643), new Complex(0.000579076882451174, -0.002288827583619), new Complex(-0.000593196052437678, 0.00205922196080042), new Complex(0.00112782513678956, -0.00102881393930718), new Complex(0.000620864112679427, 0.000915059007532448), new Complex(-0.000378372765528371, -0.000868467535198041), new Complex(0.00149521444257465, -0.000664605149120363), new Complex(0.000330042741248001, 0.00110880295331269), new Complex(-0.00155601625163024, 0.000523998790789968), new Complex(-0.000285887588516153, -0.00194085289904383), new Complex(0.000132286139871428, 0.00102039914534812), new Complex(-0.00131634450991568, -0.000787413339121431), new Complex(-0.000175934161096711, 3.81926209763376E-06), new Complex(-7.2574971384141E-05, 0.000893143496237514), new Complex(-0.00111989663901009, 0.00102052995725182), new Complex(0.000390258069476698, 0.00079121022357281), new Complex(0.00046032125281065, 0.000393738598020305), new Complex(-0.00211367094540953, -0.00100329149136896), new Complex(-0.00214449386595202, 0.00148037118026193), new Complex(0.000709000316911772, 0.00141204652061531), new Complex(0.00102018462926684, -0.00193007712258705), new Complex(0.000821237069592434, -0.000505536603992955), new Complex(0.000166894215510459, -0.000919375269167663), new Complex(-0.00233871976481139, 0.00126758994052288), new Complex(-0.000435815155001097, 5.41091546639674E-05), new Complex(0.00368736293612094, -0.002379249479601), new Complex(0.00183802454273918, 0.00155911525636617), new Complex(-0.00116370354102987, 0.00028623873042233), new Complex(0.000752405138808269, 0.00172954487343349), new Complex(0.000846906886664234, -0.00262563683667217), new Complex(0.000106107689514713, 0.000102298660225221), new Complex(0.00253274010764622, 0.000595015907782397), new Complex(0.00421420703220804, 0.000715689849177651), new Complex(0.00203326690260505, -0.00213961108944819), new Complex(0.00120010091324286, -0.00116380053338262), new Complex(0.000672001542913839, 0.000303415615537131), new Complex(-0.000786566758386079, -0.00177237404604683), new Complex(0.000323743606108142, -0.00171612377904698), new Complex(0.00076905635081682, -0.00127593394017936), new Complex(-0.000183410744744305, 0.00354135492950262), new Complex(0.000266451419360885, -0.0002641295065749), new Complex(0.00226880418947676, 0.00169466673879134), new Complex(0.00174691466039087, -0.000292016486468043), new Complex(-0.0010911079094419, 0.0015417696278092), new Complex(-0.00253661324908386, 0.00137311546794165), new Complex(-0.00130659376697825, -0.00516856298304772), new Complex(0.000339231509010886, 0.00105830616646315), new Complex(-0.000266283982508233, 0.00285278021801061), new Complex(-0.000964245116843591, 0.000154962543841945), new Complex(0.00124131476477922, 0.0025210683248388), new Complex(0.000261725036056474, -0.00167988679937271), new Complex(-0.00323106311429834, 0.00427169559316432), new Complex(-0.00115842617110187, 0.00103257247849017), new Complex(0.00156534394192181, -0.00202031495405694), new Complex(0.000234441575411342, -0.00370742187316286), new Complex(-0.000845325832518439, 0.000672184169243724), new Complex(-0.00117105115882817, 0.000790189124908761), new Complex(0.00168824726719196, -0.00439424605789216), new Complex(0.00424729395945661, -0.00122958488544135), new Complex(0.00183029357083775, 0.00375538421493481), new Complex(-0.00165397229782266, 0.000695139528242905), new Complex(0.000902546527060024, 0.00395205864945128), new Complex(0.00127889484456258, -0.00230242453214189), new Complex(-0.00401238416834442, 0.00215011789604507), new Complex(-0.00137533179714012, 0.00279864710960109), new Complex(0.00572433865228097, 0.00608451122326489), new Complex(-0.00185816175866873, -0.00837271600900952), new Complex(-0.00941310613507921, 0.00894339598666553), new Complex(0.00448645149865243, -0.00131259908877677), new Complex(0.00631226837523192, -0.00749566771529472), new Complex(-0.00526420559001898, -0.000234900748010261), new Complex(0.00103323730153025, 0.0144021228703701), new Complex(0.00990556813968383, -0.00165362141970846), new Complex(0.035313098042111, -0.00267669681148568), new Complex(0.0404539625532516, -0.0180346866333693), new Complex(0.0122945520296845, 0.000481965917439119), new Complex(0.0594630618398305, 0.0463551719184836), new Complex(0.170978666438979, -0.0513549736724585), new Complex(0.0114941806641346, -0.363410946532113), new Complex(-0.248960047670431, 0.155867683317965), new Complex(-0.103033524609103, -0.190778572428625), };
        readonly private static Complex[] door = new Complex[] {new Complex(0.85592475970323,0.156582932821587),new Complex(0.0853328502486818,-0.243535695454547),new Complex(-0.037384473611116,0.0592534920532425),new Complex(-0.266933104681354,0.250815528025618),new Complex(-0.0166352870563216,-0.024913172160225),new Complex(-0.173172162885395,-0.123481291283231),new Complex(0.0244301033249129,0.00432801365822394),new Complex(0.0278409640837826,0.000429015576258872),new Complex(-0.00266340419982812,-0.00831614821771662),new Complex(-0.0111119195850364,0.0284014887880278),new Complex(-0.0129204480056118,0.000722963451616887),new Complex(-0.020433693933329,-0.0119423624477307),new Complex(0.00649195285033482,-0.000303732770759096),new Complex(-0.00104996489023872,-0.00566333579673861),new Complex(0.00467362728538127,0.00116040694143399),new Complex(-0.0118858090401518,0.0022951391136966),new Complex(-0.00492902589636204,0.00330843816210423),new Complex(-0.0013288111765608,-0.00217346995462856),new Complex(0.000495437209006131,-0.00417382717919924),new Complex(-0.00833314996485317,0.00228265633237801),new Complex(0.00544707433521677,0.00086345667178997),new Complex(-0.0030388493856452,-0.00411990539839969),new Complex(0.000456887495753307,0.00489424822231504),new Complex(-0.00210566932981256,0.00248436500798679),new Complex(-0.000378732710845017,-0.00147357835275665),new Complex(-0.0022917600679976,-0.00430824445148708),new Complex(0.00133430139009703,-1.79248952864025E-05),new Complex(-0.00198526765885781,-0.00245027456217504),new Complex(0.000611513951458556,0.000827750839656842),new Complex(-0.0024383841848998,0.00174738779077201),new Complex(-0.00173197731187161,-0.000382021026992789),new Complex(-0.00166428246141701,-0.000835074968298214),new Complex(0.000854303262673202,3.62290291519848E-05),new Complex(0.000633242972809269,-0.00208665227992698),new Complex(0.00128810994255691,-0.00117083135405896),new Complex(0.00203723216375065,0.00267361826925189),new Complex(0.00198053252866807,0.00143027586869386),new Complex(-0.000520367570845949,-6.67346273858451E-05),new Complex(0.0053633429372837,0.000762641803267104),new Complex(-0.00179867112735809,-0.00118803097847582),new Complex(0.00251964942349994,-0.000892651128752649),new Complex(0.0023437109941107,0.000554800021300467),new Complex(0.00146548346595813,-5.09504666099289E-05),new Complex(0.000847732937298917,-0.000248746213100075),new Complex(0.000619370779254851,0.00163246823271804),new Complex(-0.00255348517149587,-0.00018632488321889),new Complex(-0.0011791056436244,-0.000689947582278844),new Complex(-0.00112783804682313,0.000285544359401903),new Complex(-0.000221322800744277,-0.00113687197242805),new Complex(-0.000308245794619938,-0.000849819193831428),new Complex(-0.00149993345091189,-0.000437440234742545),new Complex(-0.00109200830704026,0.000923124248842208),new Complex(-0.00135687290605574,0.00134045150013543),new Complex(0.00224228413428031,-0.00116036633548931),new Complex(-0.000961304147028483,-0.000563782788603423),new Complex(0.00205626221045986,-9.72338975836375E-05),new Complex(-0.00300614183551731,0.000329087298594464),new Complex(0.00142590304942248,0.00103618162508847),new Complex(-0.000487096193015305,-0.000886235936913241),new Complex(-6.91260276809086E-05,4.1498050849435E-05),new Complex(0.000128263050038684,0.0015787726639258),new Complex(0.000271070630179401,3.02939522975239E-05),new Complex(0.00046108132438551,-0.00162225804452103),new Complex(-0.000905847910333138,1.52097105960016E-05),new Complex(0.0019400422520645,-0.000660116482430599),new Complex(-0.00274170044414558,-0.000269925380936135),new Complex(-8.52245778142571E-05,0.000857141099940226),new Complex(-0.00162019699483866,0.00205678970922507),new Complex(-0.000210013769698562,-0.0010535121855255),new Complex(0.0007207727705388,-0.00150198220304883),new Complex(1.24171517885129E-05,0.000146973826453096),new Complex(-5.20994787948448E-05,-9.05964773713861E-06),new Complex(-0.000243192551157092,-0.000188879496698335),new Complex(-0.000494602451211197,0.00020952820022263),new Complex(0.000143463116131981,-0.00109492330916419),new Complex(0.000274498335791614,0.00111616394290478),new Complex(5.46762141436065E-05,0.000443731555202813),new Complex(-0.000237163566313885,-0.000902814447023525),new Complex(0.00079662611134108,-0.000593813720140689),new Complex(0.00101601646136154,0.00119734134010782),new Complex(-0.000396465932877929,0.000879481767898462),new Complex(0.00170842395925921,-0.000609564182180263),new Complex(0.000263082534310644,-0.0008717878303388),new Complex(-8.64174270074709E-05,0.000131523601610438),new Complex(0.000766127862839597,2.42783712646119E-05),new Complex(0.000580265613797649,-0.000206541973651993),new Complex(-0.002171268389513,-0.000196614210634207),new Complex(-0.000195853703878662,0.000142664582194583),new Complex(-0.00246903125566831,0.00104592106794392),new Complex(-0.000875383715997161,5.37481889834261E-05),new Complex(-0.000626840013240151,-0.00131760290081005),new Complex(-0.000310886961709902,-0.000814435770331137),new Complex(-0.00106692455732024,0.00129353851784878),new Complex(-0.000378168400866969,0.000567889472988125),new Complex(-0.000246467254015133,-0.00190498380928298),new Complex(0.000641877928101626,0.000807893447593844),new Complex(0.000665654456539502,0.0014953670702405),new Complex(0.001933326760296,-0.00199884225083738),new Complex(0.000232407066812038,-0.000614344281870933),new Complex(-0.000542882072637438,0.000844819177127405),new Complex(0.000444294685755736,-0.000379882974214829),new Complex(2.4945514356867E-05,-0.000110227297110273),new Complex(0.000854184312246976,0.00076687639030916),new Complex(9.91381007208911E-05,0.00102802334063539),new Complex(0.000592730485538365,-0.000651085449629295),new Complex(-0.0012411178078551,-0.0015843200980039),new Complex(9.83640016821425E-06,0.000408659977107496),new Complex(0.000456339298704004,9.0398477499151E-05),new Complex(-0.000766493133401566,0.000115655800617796),new Complex(-0.000427045259783575,0.00051285456271441),new Complex(-0.00119849291129458,-0.000360297161945276),new Complex(-0.0015196410703152,0.000366816312554673),new Complex(-0.000514040873853807,0.00103048101408558),new Complex(0.000847093547132,-0.00216862886498969),new Complex(-0.00104283801121603,-0.00136441714342623),new Complex(0.000340522881930072,0.000897942878656097),new Complex(-0.00238463101170857,0.00101627963452044),new Complex(-0.000489229471319405,-0.00109340410619998),new Complex(-0.00124073423320955,0.000224890958258755),new Complex(0.000330977140242096,0.000957829163086195),new Complex(0.000158565387642394,-0.000308402033581706),new Complex(0.000266844200894459,-0.000672602796836525),new Complex(0.000875841138414777,-0.000196766347031495),new Complex(2.05865876366617E-06,-0.000900301731863472),new Complex(0.000999103463529777,0.000580016753215702),new Complex(0.000140146718765421,0.00137824081428129),new Complex(-0.000530252090737654,-0.000468369969594694),new Complex(-0.000212282298623899,-0.00074147599679504),new Complex(-0.000837437657908512,0.000446702604554011),new Complex(-0.0010997461626018,0.000254979029477621),new Complex(0.00046307349025917,-0.000680328958703547),new Complex(-0.000618098405435753,-0.000301395586374315),new Complex(-0.000199811687039698,0.00048638290090584),new Complex(0.000954488903599364,0.000116378756955448),new Complex(-0.000348310181040474,-0.000553630552186539),new Complex(-0.000348310181041688,-0.000553630552186477),new Complex(0.000954488903599476,0.000116378756955781),new Complex(-0.000199811687039001,0.00048638290090513),new Complex(-0.000618098405434989,-0.00030139558637481),new Complex(0.000463073490256406,-0.000680328958703777),new Complex(-0.00109974616260521,0.000254979029478829),new Complex(-0.000837437657909562,0.000446702604555207),new Complex(-0.000212282298621844,-0.000741475996795705),new Complex(-0.00053025209073403,-0.000468369969595794),new Complex(0.000140146718768342,0.00137824081428062),new Complex(0.000999103463530844,0.000580016753216349),new Complex(2.05865876232312E-06,-0.000900301731862051),new Complex(0.000875841138413385,-0.000196766347031778),new Complex(0.000266844200894219,-0.00067260279683696),new Complex(0.000158565387643008,-0.000308402033581203),new Complex(0.000330977140241268,0.000957829163085258),new Complex(-0.00124073423320982,0.000224890958259152),new Complex(-0.000489229471318659,-0.00109340410619945),new Complex(-0.00238463101170907,0.00101627963451958),new Complex(0.00034052288192974,0.000897942878656565),new Complex(-0.00104283801121683,-0.00136441714342604),new Complex(0.000847093547132922,-0.00216862886498962),new Complex(-0.000514040873853502,0.00103048101408493),new Complex(-0.00151964107031391,0.000366816312554991),new Complex(-0.00119849291129521,-0.000360297161945246),new Complex(-0.000427045259783949,0.000512854562714147),new Complex(-0.00076649313340152,0.000115655800618183),new Complex(0.000456339298703493,9.03984774993154E-05),new Complex(9.83640016742305E-06,0.000408659977106705),new Complex(-0.00124111780785466,-0.00158432009800347),new Complex(0.000592730485539129,-0.000651085449628773),new Complex(9.91381007202388E-05,0.00102802334063429),new Complex(0.000854184312247188,0.000766876390309545),new Complex(2.49455143567136E-05,-0.000110227297109779),new Complex(0.000444294685755481,-0.00037988297421504),new Complex(-0.000542882072637689,0.000844819177127679),new Complex(0.000232407066814149,-0.000614344281870886),new Complex(0.00193332676029719,-0.00199884225083798),new Complex(0.000665654456539847,0.00149536707024039),new Complex(0.000641877928100377,0.000807893447593351),new Complex(-0.000246467254016224,-0.00190498380928186),new Complex(-0.000378168400869411,0.000567889472988602),new Complex(-0.00106692455732133,0.00129353851784789),new Complex(-0.000310886961708847,-0.000814435770331117),new Complex(-0.000626840013238791,-0.0013176029008106),new Complex(-0.000875383715997531,5.37481889832226E-05),new Complex(-0.00246903125566916,0.00104592106794526),new Complex(-0.000195853703878422,0.000142664582194151),new Complex(-0.00217126838951241,-0.000196614210635028),new Complex(0.000580265613798214,-0.000206541973651619),new Complex(0.000766127862837913,2.42783712638829E-05),new Complex(-8.64174270078517E-05,0.000131523601611508),new Complex(0.000263082534310662,-0.000871787830338248),new Complex(0.00170842395926034,-0.000609564182180863),new Complex(-0.000396465932876814,0.000879481767898357),new Complex(0.00101601646136365,0.00119734134010775),new Complex(0.000796626111341272,-0.000593813720141224),new Complex(-0.000237163566314243,-0.000902814447023072),new Complex(5.46762141419204E-05,0.000443731555203279),new Complex(0.000274498335790813,0.00111616394290506),new Complex(0.000143463116131443,-0.00109492330916483),new Complex(-0.000494602451210374,0.000209528200222062),new Complex(-0.000243192551157202,-0.000188879496698523),new Complex(-5.2099478795168E-05,-9.05964773634547E-06),new Complex(1.24171517878904E-05,0.000146973826453651),new Complex(0.000720772770539771,-0.00150198220304953),new Complex(-0.000210013769697767,-0.00105351218552644),new Complex(-0.00162019699483964,0.00205678970922483),new Complex(-8.52245778181342E-05,0.000857141099940648),new Complex(-0.00274170044414856,-0.000269925380934773),new Complex(0.0019400422520641,-0.000660116482430326),new Complex(-0.000905847910330636,1.52097105950537E-05),new Complex(0.000461081324388884,-0.00162225804452212),new Complex(0.000271070630182416,3.02939522974284E-05),new Complex(0.000128263050038625,0.00157877266392686),new Complex(-6.91260276820924E-05,4.14980508496943E-05),new Complex(-0.000487096193016569,-0.000886235936913214),new Complex(0.00142590304942268,0.00103618162508915),new Complex(-0.00300614183551785,0.00032908729859304),new Complex(0.00205626221046054,-9.72338975834016E-05),new Complex(-0.000961304147028232,-0.000563782788603301),new Complex(0.00224228413427942,-0.00116036633549037),new Complex(-0.00135687290605742,0.00134045150013557),new Complex(-0.00109200830704219,0.000923124248843262),new Complex(-0.00149993345091265,-0.000437440234741442),new Complex(-0.000308245794618325,-0.000849819193831945),new Complex(-0.000221322800738637,-0.00113687197242906),new Complex(-0.00112783804681858,0.000285544359400904),new Complex(-0.0011791056436243,-0.000689947582278882),new Complex(-0.00255348517149844,-0.000186324883217319),new Complex(0.000619370779252037,0.00163246823271921),new Complex(0.000847732937298306,-0.000248746213100931),new Complex(0.00146548346595829,-5.09504666111152E-05),new Complex(0.00234371099411135,0.000554800021300799),new Complex(0.00251964942349902,-0.00089265112875273),new Complex(-0.00179867112735785,-0.00118803097847516),new Complex(0.00536334293728386,0.000762641803267358),new Complex(-0.000520367570845927,-6.67346273867735E-05),new Complex(0.00198053252866791,0.00143027586869381),new Complex(0.00203723216375015,0.0026736182692524),new Complex(0.00128810994255584,-0.00117083135405924),new Complex(0.000633242972808372,-0.00208665227992689),new Complex(0.000854303262673193,3.62290291522648E-05),new Complex(-0.00166428246141698,-0.000835074968298774),new Complex(-0.00173197731187104,-0.000382021026992724),new Complex(-0.0024383841848996,0.00174738779077188),new Complex(0.000611513951459172,0.00082775083965642),new Complex(-0.00198526765885813,-0.00245027456217453),new Complex(0.00133430139009622,-1.79248952860056E-05),new Complex(-0.00229176006799799,-0.00430824445148798),new Complex(-0.000378732710843707,-0.00147357835275589),new Complex(-0.00210566932981285,0.00248436500798669),new Complex(0.000456887495751946,0.00489424822231405),new Complex(-0.0030388493856451,-0.00411990539839877),new Complex(0.00544707433521664,0.00086345667179024),new Complex(-0.00833314996485442,0.00228265633237686),new Complex(0.000495437209006416,-0.00417382717919821),new Complex(-0.00132881117656041,-0.00217346995462844),new Complex(-0.00492902589636089,0.00330843816210345),new Complex(-0.0118858090401508,0.00229513911369599),new Complex(0.00467362728538175,0.00116040694143475),new Complex(-0.00104996489023982,-0.00566333579673835),new Complex(0.00649195285033383,-0.000303732770758458),new Complex(-0.0204336939333278,-0.0119423624477327),new Complex(-0.0129204480056115,0.000722963451616557),new Complex(-0.011111919585037,0.0284014887880279),new Complex(-0.00266340419982824,-0.00831614821771744),new Complex(0.0278409640837837,0.000429015576261739),new Complex(0.0244301033249102,0.0043280136582245),new Complex(-0.173172162885384,-0.123481291283244),new Complex(-0.0166352870563204,-0.0249131721602196),new Complex(-0.266933104681369,0.250815528025597),new Complex(-0.0373844736111085,0.059253492053232),new Complex(0.0853328502486974,-0.243535695454548)};
        readonly private static Complex[] right = new Complex[] { new Complex(-2.32970755631388, -0.562144680900325), new Complex(0.503172608708019, 0.443563358814679), new Complex(0.493680652546542, -0.227458165550481), new Complex(0.0153360053080025, 0.0542013349009731), new Complex(0.0101416281898968, 0.0177533205375254), new Complex(0.0173758820337235, 0.000872626592518227), new Complex(0.0312374935015414, -0.0219168498793184), new Complex(0.00132107201540627, 0.0244674068998869), new Complex(0.00335204216214386, -0.0121311444056582), new Complex(0.00526469945741205, 0.00558756970877744), new Complex(0.010240124020522, -0.00201057040619057), new Complex(0.00120926902036723, -0.00202275475458865), new Complex(0.00749146823938444, 0.00198262634846544), new Complex(0.0106853696462732, 0.00168458289561371), new Complex(0.0121805302625367, -0.00587016914226529), new Complex(0.00903154186271066, 0.00304178449585266), new Complex(0.00756598643926323, 0.00101008078808641), new Complex(0.00760047657590148, -0.00265629470040667), new Complex(0.00726874965159253, -0.000294123911621743), new Complex(-0.00105855820456022, 0.00173270074861723), new Complex(-0.000661339990995994, -0.00147723402357131), new Complex(-0.00229436977562206, 0.000700948324201924), new Complex(-0.0014385193805798, -0.00189996013298722), new Complex(-0.00398861986344935, 0.00297684780948592), new Complex(0.00383081292918725, -0.00153487909806689), new Complex(0.00420544602360723, -0.00118751458292102), new Complex(0.00135292004680102, 0.00316431300974223), new Complex(0.00111889924336839, -0.00115350125470877), new Complex(0.00138834904672637, -0.00160106306210607), new Complex(0.000326842208706895, 0.00336445336198251), new Complex(0.00204654488490463, -0.00133557562321339), new Complex(-0.000226083950081686, -0.000959228033157997), new Complex(-0.00257332281340208, 0.00132896008974311), new Complex(-0.00324847825145199, 0.000733864349701168), new Complex(-0.000744975461428468, -0.00253294802806522), new Complex(-0.000439475223613428, 0.00167469065732011), new Complex(-0.000568402814408968, -8.43179629893114E-06), new Complex(-0.00207063150527345, -0.000799534723250154), new Complex(0.00130501012089289, -0.000864117341288045), new Complex(0.000957006401991363, 0.00220455023367127), new Complex(0.00455396753062876, -0.00195709516043473), new Complex(0.000443145608931883, -0.000177885488814318), new Complex(0.000663021008659695, 0.0014261792655919), new Complex(0.00243811812041861, -0.000640599400921248), new Complex(0.00205855248355469, -0.00103417593921694), new Complex(-0.000971788863806127, 0.00105248612273097), new Complex(-0.00175192509209655, 0.000984533878856869), new Complex(0.00127865129208316, -0.00254316179728783), new Complex(0.000693861276894631, 0.0017296457019169), new Complex(-0.000364840430234988, 0.000820986151746258), new Complex(0.0014037415048116, -0.00203036274620331), new Complex(-0.000516029798828757, 0.00125075792293552), new Complex(0.00179687981115317, 0.000764040690618078), new Complex(0.00223200364715943, -0.00170505761912484), new Complex(-0.00101676206060015, 0.00163152284431518), new Complex(0.00117188118229654, -0.000413324353977821), new Complex(0.00134412377759495, -0.000912956619002503), new Complex(-0.000967402636693208, 0.00168147590707902), new Complex(0.000120551396445229, -0.00144054399088423), new Complex(-0.00220704062781724, 0.00066385967361415), new Complex(0.00126789183180829, -0.00100510790244499), new Complex(-0.00187213877026819, 0.00160482138842659), new Complex(-0.00134108100888847, -0.00169775555567179), new Complex(-0.00189839595409094, 0.00018706780731832), new Complex(-0.00223232063621528, 0.000497137529953688), new Complex(-0.0015145185090161, 0.000472737056073402), new Complex(0.000786942018805356, -0.00204751754531953), new Complex(0.00016827101895318, 0.00188308190858141), new Complex(0.00175221866614286, 8.7975744333403E-05), new Complex(0.00241609641047059, -0.00103381816212267), new Complex(0.00121152446911332, 0.000167679151642775), new Complex(0.00131394801637605, 0.00163340409887124), new Complex(0.00200478153756119, -0.00165624742558489), new Complex(-0.00210883992162859, 0.000391093532947987), new Complex(-0.00137543048113733, 0.000907431200257302), new Complex(0.000386940902222029, -0.00091005821530352), new Complex(7.31443226562629E-05, 0.000198376098250317), new Complex(-0.000665479610096167, 0.000165679930197397), new Complex(-0.000685352356526245, 6.51487700800425E-06), new Complex(0.000994845547583876, -0.000531202431703565), new Complex(0.00182936037319655, 0.000591488411313297), new Complex(0.000564007846803276, -0.000322726207067917), new Complex(0.000564007846801084, -0.000322726207068993), new Complex(0.00182936037319787, 0.000591488411314155), new Complex(0.00099484554758484, -0.000531202431704198), new Complex(-0.000685352356523773, 6.51487700808078E-06), new Complex(-0.000665479610096526, 0.000165679930197651), new Complex(7.31443226517772E-05, 0.000198376098249766), new Complex(0.00038694090222314, -0.000910058215302933), new Complex(-0.00137543048113465, 0.000907431200257048), new Complex(-0.00210883992162812, 0.000391093532948227), new Complex(0.00200478153755769, -0.00165624742558513), new Complex(0.00131394801637545, 0.00163340409887149), new Complex(0.0012115244691152, 0.000167679151642427), new Complex(0.00241609641047098, -0.00103381816212246), new Complex(0.00175221866614023, 8.79757443335732E-05), new Complex(0.000168271018952558, 0.00188308190858033), new Complex(0.000786942018810388, -0.00204751754531831), new Complex(-0.00151451850902185, 0.000472737056072684), new Complex(-0.00223232063621907, 0.000497137529953418), new Complex(-0.00189839595408273, 0.000187067807319514), new Complex(-0.00134108100888793, -0.00169775555567285), new Complex(-0.00187213877027291, 0.00160482138842723), new Complex(0.00126789183180481, -0.00100510790244506), new Complex(-0.00220704062781275, 0.00066385967361373), new Complex(0.000120551396451275, -0.00144054399088314), new Complex(-0.000967402636698037, 0.00168147590707762), new Complex(0.00134412377759437, -0.000912956619001534), new Complex(0.00117188118229632, -0.000413324353978084), new Complex(-0.00101676206059911, 0.00163152284431468), new Complex(0.0022320036471645, -0.0017050576191241), new Complex(0.00179687981115199, 0.000764040690617444), new Complex(-0.000516029798831827, 0.00125075792293593), new Complex(0.00140374150481046, -0.002030362746204), new Complex(-0.000364840430230637, 0.00082098615174714), new Complex(0.000693861276893733, 0.00172964570191636), new Complex(0.00127865129208225, -0.00254316179728771), new Complex(-0.001751925092096, 0.000984533878857187), new Complex(-0.000971788863809007, 0.00105248612273028), new Complex(0.00205855248355241, -0.00103417593921611), new Complex(0.00243811812041624, -0.000640599400922289), new Complex(0.000663021008664658, 0.00142617926559269), new Complex(0.000443145608933613, -0.000177885488814804), new Complex(0.00455396753062764, -0.00195709516043479), new Complex(0.000957006401991447, 0.00220455023367146), new Complex(0.00130501012089296, -0.000864117341288168), new Complex(-0.00207063150527365, -0.000799534723249805), new Complex(-0.000568402814410537, -8.43179629918039E-06), new Complex(-0.00043947522361501, 0.00167469065732079), new Complex(-0.000744975461428971, -0.00253294802806566), new Complex(-0.00324847825144849, 0.000733864349702066), new Complex(-0.00257332281340072, 0.0013289600897422), new Complex(-0.00022608395008168, -0.000959228033157029), new Complex(0.00204654488490107, -0.00133557562321447), new Complex(0.000326842208708629, 0.00336445336198354), new Complex(0.00138834904672791, -0.00160106306210714), new Complex(0.00111889924337124, -0.00115350125470748), new Complex(0.00135292004679757, 0.00316431300974112), new Complex(0.00420544602360741, -0.00118751458292051), new Complex(0.00383081292918828, -0.00153487909806704), new Complex(-0.00398861986345109, 0.00297684780948565), new Complex(-0.00143851938057972, -0.00189996013298703), new Complex(-0.00229436977562021, 0.000700948324202363), new Complex(-0.000661339990997073, -0.00147723402357185), new Complex(-0.00105855820456194, 0.00173270074861772), new Complex(0.00726874965159011, -0.000294123911622214), new Complex(0.00760047657590328, -0.00265629470040659), new Complex(0.00756598643926492, 0.00101008078808646), new Complex(0.0090315418627095, 0.00304178449585233), new Complex(0.0121805302625363, -0.00587016914226515), new Complex(0.0106853696462717, 0.00168458289561352), new Complex(0.00749146823938412, 0.00198262634846474), new Complex(0.00120926902037234, -0.00202275475458781), new Complex(0.0102401240205224, -0.00201057040619107), new Complex(0.00526469945741106, 0.00558756970877711), new Complex(0.00335204216214468, -0.0121311444056573), new Complex(0.00132107201540381, 0.0244674068998857), new Complex(0.0312374935015428, -0.0219168498793187), new Complex(0.0173758820337239, 0.000872626592517495), new Complex(0.0101416281898958, 0.0177533205375251), new Complex(0.0153360053080021, 0.0542013349009734), new Complex(0.493680652546542, -0.227458165550491), new Complex(0.503172608708048, 0.443563358814663), };
        readonly private static Complex[] left = new Complex[] { new Complex(-2.57232699354439, 0.314789641685236), new Complex(0.780832086408857, -0.332663858367073), new Complex(0.357615833342961, 0.203952513163603), new Complex(-0.0418979244239389, -0.0778088603236709), new Complex(0.028634572044378, 0.0226015594162265), new Complex(0.0791002416728305, 0.0223458645974017), new Complex(0.0282628195881532, 0.00559803688137724), new Complex(-0.00704156790363002, -0.00337055485654066), new Complex(0.00222722564389291, 0.0184652965345733), new Complex(0.0137177438670374, 0.0043090901272627), new Complex(0.00921085922918046, -0.0131098270109546), new Complex(-0.00337547102240225, -0.000186475739751206), new Complex(0.00147494249216889, 0.00535513379164123), new Complex(-0.00367368361280976, -0.00920072890720576), new Complex(0.00578653307143266, -0.00335407446402741), new Complex(0.0094721238996437, 0.00418014997231858), new Complex(-0.00470597828105059, -0.00448569495516971), new Complex(-0.00844162195323987, -0.00222287906928643), new Complex(0.00277536006114672, 0.00153353118472537), new Complex(0.0098842800474564, -0.00311321350836835), new Complex(0.00337252460752574, -0.00335944602864928), new Complex(0.00186873062358114, 0.000626976270889383), new Complex(0.000438822882484311, 0.00333625298252357), new Complex(1.9243461417644E-05, -0.00142193742544424), new Complex(0.00289098212502038, 0.0014482546226997), new Complex(0.00180452593663373, 0.00426161802653174), new Complex(-0.00116846640910964, 0.000394228372102675), new Complex(-0.00124981031186285, 0.000340927379206733), new Complex(0.0016246676428791, 0.00046771055267685), new Complex(0.0019308660072285, -0.000915439181880396), new Complex(0.00234762014290894, 0.000470878614378694), new Complex(0.000646445581457835, -0.000797980008191426), new Complex(-8.8798670768468E-05, 0.000538753179705905), new Complex(-0.00145207676773812, 1.06039484171329E-05), new Complex(-0.000223270139601702, -0.00115685275574351), new Complex(0.00185618866595694, 0.000905156580177109), new Complex(-0.00219045710554245, -0.00148720933469096), new Complex(-0.0012029207647281, -0.0007174534092761), new Complex(0.00282757993661192, -0.00151293538223601), new Complex(0.00308935841375418, 0.000638330725535407), new Complex(-0.00152455786624493, 0.000138211476202059), new Complex(-0.00112701069436831, -9.69492297671534E-05), new Complex(-8.87678325762173E-05, 0.00126559878873298), new Complex(-0.00230720053804562, 0.00109876863013651), new Complex(-0.00184055897363992, -0.000643675852293665), new Complex(0.00297590280196378, 0.00131555477837897), new Complex(0.00183729962941231, -0.000389647707397521), new Complex(-0.00099639314780027, -0.000921538387850933), new Complex(0.00122043791376831, 0.00105276025530504), new Complex(0.00316612332715252, -0.000686105997408432), new Complex(0.00180874738456147, 0.000686234868875956), new Complex(-0.00102036716606888, -0.000336578400425804), new Complex(0.00024941430960393, -0.000369460034140207), new Complex(0.000279881688271409, 0.000256529496380475), new Complex(-0.000137097413593241, -0.000915120510881453), new Complex(0.000289100717463958, -0.00105760986594125), new Complex(0.000156790231178245, 0.000392459257576331), new Complex(-0.000866024706472013, -0.000542252003158992), new Complex(-0.000207239138237035, -0.000120730929006572), new Complex(0.00178790394978404, 0.00119331572174559), new Complex(0.000791786811181724, -0.000288931220688793), new Complex(-6.44274936461459E-06, 0.000708325371517652), new Complex(-0.000586254775842256, 0.000169076113591196), new Complex(0.00265400429908014, -0.000291566213665791), new Complex(0.00396594595728803, 0.00105412936579166), new Complex(0.000318544798767789, -0.0010911810298067), new Complex(-0.00307262493988239, 0.000199682336386037), new Complex(-0.0042076912689936, 0.00194861140281091), new Complex(-0.00058106752891124, -0.00219213036908247), new Complex(0.00340892828927075, 0.00114413318307567), new Complex(0.000972949514300042, 0.000156446801677032), new Complex(-0.00141595925694177, -0.000886310802400537), new Complex(0.000693414994840602, -0.00111814152652382), new Complex(0.00168186840419123, 0.00100635375606291), new Complex(0.000109316579549097, -0.000416161645036708), new Complex(-0.000750312894071062, -0.00206408213151729), new Complex(0.000146498495142683, 0.00365875927522796), new Complex(-0.000419412579752815, -0.00260065487344999), new Complex(0.00139325206589014, 0.00108816729594893), new Complex(0.000741500384889591, 0.000571582939811389), new Complex(-0.000331262334737249, -0.00036613942321871), new Complex(-0.000331262334739584, -0.00036613942321779), new Complex(0.00074150038489154, 0.000571582939810892), new Complex(0.00139325206588937, 0.00108816729594934), new Complex(-0.000419412579753492, -0.00260065487345048), new Complex(0.000146498495141824, 0.00365875927522825), new Complex(-0.000750312894072322, -0.00206408213151808), new Complex(0.000109316579545065, -0.000416161645035848), new Complex(0.00168186840419815, 0.00100635375606233), new Complex(0.00069341499484244, -0.00111814152652324), new Complex(-0.00141595925694429, -0.000886310802400575), new Complex(0.000972949514298683, 0.000156446801676721), new Complex(0.00340892828926945, 0.0011441331830759), new Complex(-0.0005810675289093, -0.00219213036908287), new Complex(-0.00420769126899498, 0.00194861140281138), new Complex(-0.00307262493988215, 0.000199682336386066), new Complex(0.000318544798770208, -0.00109118102980642), new Complex(0.00396594595728872, 0.00105412936579227), new Complex(0.00265400429907896, -0.000291566213666069), new Complex(-0.000586254775845762, 0.000169076113591566), new Complex(-6.44274935902436E-06, 0.000708325371517605), new Complex(0.000791786811185697, -0.000288931220688945), new Complex(0.00178790394977782, 0.00119331572174585), new Complex(-0.000207239138239456, -0.000120730929007155), new Complex(-0.000866024706470422, -0.000542252003158754), new Complex(0.000156790231179229, 0.000392459257576116), new Complex(0.000289100717461039, -0.00105760986594103), new Complex(-0.000137097413591406, -0.000915120510881391), new Complex(0.000279881688273097, 0.000256529496380226), new Complex(0.000249414309600167, -0.000369460034139797), new Complex(-0.00102036716606645, -0.00033657840042624), new Complex(0.00180874738456367, 0.000686234868876554), new Complex(0.00316612332715153, -0.000686105997408947), new Complex(0.00122043791376321, 0.0010527602553056), new Complex(-0.000996393147798283, -0.000921538387851559), new Complex(0.00183729962941385, -0.000389647707396489), new Complex(0.00297590280196812, 0.0013155547783778), new Complex(-0.0018405589736455, -0.000643675852292924), new Complex(-0.00230720053804475, 0.00109876863013604), new Complex(-8.87678325741754E-05, 0.00126559878873307), new Complex(-0.00112701069436837, -9.69492297667641E-05), new Complex(-0.00152455786624205, 0.000138211476201761), new Complex(0.00308935841375015, 0.000638330725535653), new Complex(0.00282757993660937, -0.00151293538223627), new Complex(-0.0012029207647237, -0.000717453409276069), new Complex(-0.00219045710554108, -0.00148720933469118), new Complex(0.00185618866595073, 0.00090515658017756), new Complex(-0.000223270139601783, -0.00115685275574426), new Complex(-0.00145207676773671, 1.06039484175905E-05), new Complex(-8.87986707633091E-05, 0.000538753179705257), new Complex(0.000646445581454859, -0.00079798000819095), new Complex(0.00234762014290663, 0.000470878614378612), new Complex(0.00193086600722932, -0.00091543918188023), new Complex(0.00162466764287919, 0.000467710552676906), new Complex(-0.00124981031186336, 0.00034092737920694), new Complex(-0.00116846640910838, 0.000394228372102608), new Complex(0.00180452593663537, 0.00426161802653192), new Complex(0.00289098212502059, 0.00144825462269921), new Complex(1.92434614130245E-05, -0.00142193742544372), new Complex(0.000438822882483731, 0.00333625298252265), new Complex(0.00186873062357999, 0.000626976270890097), new Complex(0.00337252460753056, -0.00335944602865041), new Complex(0.00988428004745414, -0.00311321350836714), new Complex(0.00277536006114694, 0.00153353118472418), new Complex(-0.00844162195324252, -0.00222287906928562), new Complex(-0.00470597828104225, -0.0044856949551704), new Complex(0.00947212389964245, 0.00418014997231951), new Complex(0.00578653307142903, -0.00335407446402733), new Complex(-0.00367368361280838, -0.00920072890720639), new Complex(0.00147494249216538, 0.00535513379164198), new Complex(-0.00337547102240077, -0.000186475739751755), new Complex(0.0092108592291817, -0.0131098270109539), new Complex(0.0137177438670401, 0.00430909012726399), new Complex(0.00222722564389846, 0.0184652965345731), new Complex(-0.00704156790363295, -0.00337055485654078), new Complex(0.0282628195881477, 0.00559803688137757), new Complex(0.0791002416728301, 0.0223458645974016), new Complex(0.0286345720443786, 0.0226015594162259), new Complex(-0.0418979244239389, -0.0778088603236702), new Complex(0.357615833342962, 0.203952513163601), new Complex(0.780832086408846, -0.332663858367063), };
        readonly private static Complex[] reset = new Complex[] { new Complex(-0.541051952864249, 0.619271672396737), new Complex(-0.0493804061101267, -0.113390691686022), new Complex(0.255629878214317, 0.0445880786505201), new Complex(0.0427334490603898, -0.202358986138294), new Complex(0.0113743672537125, -0.0738203406024254), new Complex(0.0226265619313933, 0.0511799191178032), new Complex(-0.0112631188539348, 0.0160587682371751), new Complex(-0.000264117799178286, -0.0150062197986192), new Complex(0.00368952116649914, -0.0127447522097772), new Complex(0.0100290820621422, -0.000988939390414692), new Complex(-0.000807616057424739, -0.00363695357531523), new Complex(-0.00480871160132271, -0.00210481891403893), new Complex(0.000551109102322843, 0.0134504063139586), new Complex(-0.00339557377189807, -0.00203066359146389), new Complex(0.000124254429733312, -0.00522716765622779), new Complex(0.000846787020329734, -0.00356021438814698), new Complex(0.000137185653293881, 0.00581743344653263), new Complex(-0.00239767238380077, 0.00116404851309671), new Complex(-0.00342014568259113, -0.00012445703529305), new Complex(0.000534024269552394, 0.00152679199037928), new Complex(-0.000930479301356232, -0.000599596786550201), new Complex(0.000201273688644262, -0.00283644663594929), new Complex(-0.000150748044293313, 0.0013962986872236), new Complex(-0.00131963059868365, 0.00192107824616716), new Complex(-0.0010552803491447, 0.000954496489915435), new Complex(-0.0011952813311366, -0.00336107717262758), new Complex(0.00142309267028409, 0.000774223803285097), new Complex(3.79163961746664E-05, -0.000713953917550032), new Complex(-9.56657446832953E-06, -0.000782592409166947), new Complex(-0.000141634725974566, -0.000334177336288026), new Complex(-0.00104924839765062, 2.28786503393649E-05), new Complex(0.000804268254991563, -0.000314650912593736), new Complex(-1.47315981039928E-05, -0.00306044422655881), new Complex(0.00173186014832015, 0.000148912062711241), new Complex(-0.000275625908394261, -0.000536008439388077), new Complex(-6.90658004939632E-05, -0.00110601758476637), new Complex(-6.90658004937118E-05, -0.0011060175847666), new Complex(-0.000275625908393314, -0.000536008439389256), new Complex(0.00173186014832083, 0.000148912062710852), new Complex(-1.47315981045526E-05, -0.00306044422655832), new Complex(0.00080426825499068, -0.000314650912592912), new Complex(-0.00104924839765101, 2.2878650340203E-05), new Complex(-0.000141634725974466, -0.000334177336288215), new Complex(-9.56657446817622E-06, -0.000782592409167256), new Complex(3.79163961751328E-05, -0.000713953917550572), new Complex(0.00142309267028442, 0.000774223803285159), new Complex(-0.0011952813311371, -0.00336107717262726), new Complex(-0.00105528034914529, 0.00095449648991582), new Complex(-0.0013196305986833, 0.00192107824616697), new Complex(-0.000150748044292951, 0.0013962986872234), new Complex(0.000201273688644128, -0.00283644663594923), new Complex(-0.000930479301356323, -0.00059959678655007), new Complex(0.000534024269552476, 0.00152679199037897), new Complex(-0.00342014568259076, -0.000124457035293069), new Complex(-0.00239767238380022, 0.00116404851309576), new Complex(0.000137185653293804, 0.0058174334465333), new Complex(0.000846787020329237, -0.00356021438814691), new Complex(0.000124254429732852, -0.00522716765622699), new Complex(-0.00339557377189805, -0.00203066359146392), new Complex(0.000551109102323109, 0.0134504063139583), new Complex(-0.00480871160132264, -0.00210481891403939), new Complex(-0.000807616057424542, -0.00363695357531536), new Complex(0.0100290820621425, -0.000988939390414596), new Complex(0.00368952116649848, -0.0127447522097766), new Complex(-0.000264117799178868, -0.0150062197986191), new Complex(-0.011263118853934, 0.0160587682371745), new Complex(0.0226265619313939, 0.0511799191178029), new Complex(0.0113743672537118, -0.0738203406024255), new Complex(0.0427334490603927, -0.202358986138292), new Complex(0.255629878214316, 0.0445880786505215), new Complex(-0.0493804061101257, -0.113390691686022), };
        readonly private static Complex[] half = new Complex[] { new Complex(0.612908097195186, 0.565327397260804), new Complex(-0.00320909045158626, -0.333086021045704), new Complex(0.0183964560474613, -0.00763988912176402), new Complex(-0.265319824309281, 0.0687193297796301), new Complex(-0.00741482973309998, 0.00375384881119083), new Complex(-0.0301858916006913, -0.0114275321636255), new Complex(-0.00358440120994467, 0.000621248429132815), new Complex(0.010411491802853, -0.00788736505641868), new Complex(0.00363898590798278, -0.00170383222007242), new Complex(-0.0181282017593141, 0.00713601067732755), new Complex(-0.00154558233657899, 0.00156238679583001), new Complex(-0.00895184105955081, -0.00209132167628821), new Complex(-0.00239322343273804, 0.000566834834797293), new Complex(0.0025704025510472, -0.00252609728314775), new Complex(0.000834034371374301, -0.000897762163816997), new Complex(-0.00127628803748772, 0.00225713139013309), new Complex(-0.000470913556624357, 0.000956475465466555), new Complex(-0.00195623718062019, -0.000830719518587873), new Complex(-0.000981922570811081, 0.000470394864210813), new Complex(-2.07629765371655E-05, -0.00117478119700021), new Complex(3.02351447200898E-06, -0.000590774609147596), new Complex(0.000744102874169093, 0.000982021862298168), new Complex(-0.000605313507180371, 0.00065032789280966), new Complex(0.00108619486888068, -0.000482905816879691), new Complex(7.16827331977587E-05, 0.000324783034745805), new Complex(-0.000394016140927144, -0.00054760563627779), new Complex(0.000362443522172737, -0.000442419849142372), new Complex(1.30949042048424E-05, 0.000545332870863297), new Complex(-0.000928593132869318, 0.00047960149647091), new Complex(0.00183050930976472, -0.000377581470667744), new Complex(0.000401815906595825, 0.000120883341603559), new Complex(6.58235760376929E-05, -0.000156851497873837), new Complex(0.00126379536109249, -0.000375285755417267), new Complex(-0.000780972853056547, 0.000428435904919053), new Complex(-0.000780972853056403, 0.000428435904918938), new Complex(0.00126379536109264, -0.000375285755417502), new Complex(6.58235760382968E-05, -0.000156851497873374), new Complex(0.000401815906595979, 0.000120883341603512), new Complex(0.00183050930976428, -0.000377581470667974), new Complex(-0.000928593132869893, 0.000479601496471158), new Complex(1.30949042041865E-05, 0.000545332870863157), new Complex(0.000362443522172635, -0.000442419849142315), new Complex(-0.000394016140927334, -0.000547605636277808), new Complex(7.16827331975361E-05, 0.000324783034746132), new Complex(0.00108619486888053, -0.000482905816880155), new Complex(-0.000605313507179405, 0.000650327892809451), new Complex(0.000744102874170415, 0.000982021862298858), new Complex(3.02351447260291E-06, -0.000590774609147656), new Complex(-2.0762976538081E-05, -0.00117478119700091), new Complex(-0.000981922570811575, 0.000470394864211512), new Complex(-0.00195623718062048, -0.000830719518588103), new Complex(-0.000470913556623862, 0.000956475465466398), new Complex(-0.00127628803748803, 0.00225713139013324), new Complex(0.000834034371374316, -0.000897762163816959), new Complex(0.00257040255104627, -0.00252609728314828), new Complex(-0.00239322343273795, 0.000566834834798167), new Complex(-0.00895184105955093, -0.00209132167628915), new Complex(-0.00154558233657822, 0.0015623867958306), new Complex(-0.0181282017593137, 0.00713601067732752), new Complex(0.00363898590798308, -0.00170383222007328), new Complex(0.0104114918028536, -0.0078873650564178), new Complex(-0.00358440120994506, 0.000621248429132689), new Complex(-0.0301858916006919, -0.0114275321636253), new Complex(-0.00741482973310105, 0.00375384881119082), new Complex(-0.265319824309281, 0.0687193297796289), new Complex(0.018396456047463, -0.00763988912176391), new Complex(-0.00320909045157945, -0.333086021045703), };
        readonly private static Complex[] doubl = new Complex[] { new Complex(0.196598728585007, -0.922146132794663), new Complex(0.190369022934573, 0.0169775168553631), new Complex(0.224125435320169, 0.245069972417871), new Complex(-0.234998439006487, 0.25742588824902), new Complex(-0.166663182078659, -0.0932029380339639), new Complex(0.0443408504210629, 0.031742660473904), new Complex(-0.0692963116251402, 0.00432862238985318), new Complex(-0.0160247086548413, -0.00276489753001632), new Complex(-0.0336850638721137, 0.00362031508662809), new Complex(0.0131513759755184, -0.00631276408617175), new Complex(-0.0179706997955423, 0.000835801989648491), new Complex(0.00527956435690368, -0.00391220411643032), new Complex(-0.0105267382274389, -0.0055314715860493), new Complex(-0.0042518301618823, 0.00173677331029539), new Complex(-0.00239328300398041, 0.0073891837287747), new Complex(0.001631172771111, 0.00295366505208878), new Complex(-0.00707753302295994, -0.00238289260899664), new Complex(-0.00192517457940466, 0.00398169894104909), new Complex(-0.00232516118729856, -0.000547281667913861), new Complex(0.006346243182887, -0.00062733351540133), new Complex(-0.00122204082876242, -0.00264156753907192), new Complex(0.000659428146424709, -0.000417508007378242), new Complex(-0.00252018270510062, -0.00270158827812193), new Complex(0.00173688636906529, -0.00120262860818889), new Complex(-0.00275548702100932, 8.85101167603262E-05), new Complex(-0.00398718249013959, -0.00114063151278557), new Complex(-0.000429780162787918, 0.00165197767062535), new Complex(-0.000831580299963627, 0.00182546103621962), new Complex(-0.00315188193051368, 0.00247815349928452), new Complex(0.000170254845040885, 0.000600459480829861), new Complex(0.00024177327360163, -0.000268644065191776), new Complex(0.000280193818710322, 0.00103044792986693), new Complex(0.000807865559660282, -0.00277105695052425), new Complex(0.00101542396678338, -0.00240672510791321), new Complex(-0.0016296188427095, -0.00245806715229836), new Complex(0.000405735900952124, 0.000232212505132175), new Complex(-0.00183277293558616, 0.000329932490603073), new Complex(0.00453852521442707, 0.00178220122192597), new Complex(-0.0040059910006537, 0.00405243779472018), new Complex(0.00122285414994247, 0.00303028203809134), new Complex(0.000704334050527798, 0.000138070934135041), new Complex(0.000553968276182141, -0.00390806125614384), new Complex(-0.00338681771197767, -0.00199947179859792), new Complex(0.000926545761850292, 0.00139209415820204), new Complex(0.00296341428140885, -0.00277293770697056), new Complex(0.00404286620097996, 0.00027818582199623), new Complex(-0.00158041109661174, 0.00358115150471392), new Complex(0.000453487585877187, 0.000869408226685236), new Complex(0.00156472860677112, -0.00301627831186759), new Complex(0.00348161445495243, 0.000305234093183093), new Complex(-0.00410225249709987, 1.3654986303363E-05), new Complex(0.000982857200495132, -0.000775538408443696), new Complex(0.00291544098245514, -0.00126730574111919), new Complex(0.000663041271354076, 0.0014094844049426), new Complex(-0.000326076304742219, 0.000727943580633176), new Complex(-0.000100044985787017, -0.00057868913893297), new Complex(0.000414549074049862, -0.000446523709275662), new Complex(-0.000355668084986407, 0.00109918366994023), new Complex(0.000856169015691925, 0.00160559463733633), new Complex(0.00090505184273281, -0.00145198582774514), new Complex(-0.000350579920270658, -0.000908969396281291), new Complex(-0.00251850700098032, -0.00057599555651135), new Complex(0.000481463196546494, 0.000811669867774654), new Complex(0.00128114256412763, -0.00162251915785607), new Complex(0.000309844838181186, 0.00218452461600746), new Complex(-0.000532889782543207, 0.00214026771446128), new Complex(-0.00145836429393899, -0.000714456906813338), new Complex(-0.000941247315023977, -0.00101747855544071), new Complex(0.000707114607473934, 0.000553818391054819), new Complex(-0.0011790606136878, -3.36253079082249E-05), new Complex(0.000500859327925008, -0.000728742336690122), new Complex(-0.000992138387018321, 0.000587124302887316), new Complex(-0.00196639403055899, 0.00161026114271339), new Complex(0.00254716078456685, -0.00061262381259681), new Complex(-0.00172148534131965, 3.87091966457372E-05), new Complex(-0.000379522041115198, 0.000270652842741518), new Complex(-0.00102018754936851, -0.000722695701676308), new Complex(-0.000707492912812479, 0.000127146519050595), new Complex(0.00251961981425321, 0.000146627486461063), new Complex(-0.00110497815932205, 0.00125259577189899), new Complex(-0.000353027909802113, -0.000697292821643294), new Complex(0.000970064658298411, -0.000458626788346496), new Complex(-0.000602980729582983, -0.000656798933742224), new Complex(-0.000803266245119759, -0.00202511769411363), new Complex(-0.000159063207812444, 0.00184604968631333), new Complex(0.000410216920635843, -0.000692955748829273), new Complex(-0.000120116419554294, 0.000815618037402364), new Complex(-0.000940687171305844, 0.000184935280090999), new Complex(-0.000522262899589233, -0.000355292334764782), new Complex(-0.00236316666937194, -0.000133795810202788), new Complex(-0.00119729611114696, 0.000666567724394278), new Complex(0.000195438173283551, 0.00160555430072424), new Complex(-0.000187213597908603, -0.000968700800523911), new Complex(-0.00221260604736507, 0.000603274693964544), new Complex(-0.0014954605224011, 0.000954219700067353), new Complex(0.000935280514693641, -0.000304350619767456), new Complex(0.000151427454380981, -0.00121276309685244), new Complex(-0.000559032638628515, 0.000850031463825874), new Complex(-0.0022291721751652, -0.000270678307686714), new Complex(-0.00139371632629568, -0.00166659165848431), new Complex(0.000682293960742315, 0.00183098611679169), new Complex(-0.000344929387755373, 0.00155944788462308), new Complex(-0.000952928483195942, 0.00150755862082459), new Complex(0.000690118637332499, 0.000247545515820657), new Complex(-0.00206044194236275, 0.000214765262558172), new Complex(-0.00127991298788744, -0.000244510989703328), new Complex(0.00195580347242256, -0.00128476519875412), new Complex(-0.00153720529078097, -0.000639174088594425), new Complex(0.000435444359273569, 0.000994902750728799), new Complex(0.000949743928429874, 0.00110390652775105), new Complex(0.00129860177015422, -0.00149503077423591), new Complex(0.00066968964049134, -0.00109889018209343), new Complex(-0.00137673166323069, 0.00171479071183975), new Complex(0.00162987363207671, -0.00205839685495643), new Complex(0.001451257753756, -0.000736766649936243), new Complex(9.74807746939038E-05, 0.00150993232179783), new Complex(9.74807746939803E-05, 0.00150993232179848), new Complex(0.00145125775375445, -0.0007367666499372), new Complex(0.00162987363207309, -0.00205839685495472), new Complex(-0.00137673166323298, 0.00171479071184284), new Complex(0.000669689640489697, -0.00109889018209042), new Complex(0.00129860177015361, -0.0014950307742385), new Complex(0.000949743928430723, 0.00110390652774939), new Complex(0.000435444359275398, 0.000994902750728016), new Complex(-0.00153720529078004, -0.000639174088594115), new Complex(0.00195580347242238, -0.00128476519875479), new Complex(-0.0012799129878876, -0.000244510989703756), new Complex(-0.00206044194236316, 0.000214765262559688), new Complex(0.0006901186373322, 0.00024754551582201), new Complex(-0.000952928483196275, 0.00150755862082456), new Complex(-0.000344929387754645, 0.00155944788462227), new Complex(0.000682293960743644, 0.0018309861167911), new Complex(-0.00139371632629429, -0.00166659165848542), new Complex(-0.00222917217516519, -0.000270678307687294), new Complex(-0.000559032638628415, 0.000850031463826024), new Complex(0.000151427454380799, -0.00121276309685115), new Complex(0.000935280514693292, -0.000304350619766983), new Complex(-0.00149546052240124, 0.000954219700066476), new Complex(-0.00221260604736479, 0.000603274693964786), new Complex(-0.000187213597907496, -0.000968700800524854), new Complex(0.000195438173283265, 0.00160555430072432), new Complex(-0.00119729611114749, 0.000666567724393375), new Complex(-0.00236316666937256, -0.000133795810200492), new Complex(-0.000522262899588861, -0.000355292334763798), new Complex(-0.000940687171306043, 0.000184935280089389), new Complex(-0.000120116419554316, 0.000815618037399947), new Complex(0.000410216920635808, -0.000692955748828844), new Complex(-0.000159063207814569, 0.00184604968631526), new Complex(-0.000803266245121824, -0.00202511769411158), new Complex(-0.000602980729583578, -0.000656798933740942), new Complex(0.000970064658298443, -0.000458626788347753), new Complex(-0.0003530279098014, -0.000697292821644934), new Complex(-0.00110497815931995, 0.00125259577189882), new Complex(0.00251961981425425, 0.000146627486460334), new Complex(-0.000707492912812807, 0.000127146519049538), new Complex(-0.00102018754936891, -0.000722695701675595), new Complex(-0.000379522041116042, 0.000270652842743701), new Complex(-0.00172148534132045, 3.87091966466783E-05), new Complex(0.00254716078456684, -0.000612623812597245), new Complex(-0.00196639403055797, 0.00161026114271199), new Complex(-0.00099213838701718, 0.000587124302886368), new Complex(0.000500859327925824, -0.000728742336690414), new Complex(-0.0011790606136879, -3.36253079085104E-05), new Complex(0.000707114607472603, 0.000553818391056185), new Complex(-0.000941247315023881, -0.0010174785554394), new Complex(-0.00145836429393899, -0.000714456906812591), new Complex(-0.000532889782542898, 0.00214026771445852), new Complex(0.00030984483818138, 0.00218452461600653), new Complex(0.00128114256412806, -0.00162251915785449), new Complex(0.000481463196546154, 0.000811669867775344), new Complex(-0.00251850700098094, -0.000575995556511078), new Complex(-0.000350579920269528, -0.000908969396282045), new Complex(0.000905051842733641, -0.00145198582774488), new Complex(0.000856169015693048, 0.00160559463733529), new Complex(-0.000355668084985548, 0.00109918366994008), new Complex(0.000414549074051062, -0.000446523709276029), new Complex(-0.000100044985785953, -0.000578689138933177), new Complex(-0.000326076304741941, 0.000727943580631949), new Complex(0.000663041271353907, 0.00140948440494226), new Complex(0.0029154409824537, -0.00126730574111867), new Complex(0.00098285720049232, -0.000775538408442095), new Complex(-0.00410225249710325, 1.3654986305423E-05), new Complex(0.00348161445494987, 0.000305234093186054), new Complex(0.00156472860677037, -0.00301627831186692), new Complex(0.000453487585878449, 0.000869408226684209), new Complex(-0.00158041109660864, 0.00358115150471022), new Complex(0.00404286620098268, 0.000278185821993843), new Complex(0.00296341428141053, -0.00277293770697115), new Complex(0.000926545761850235, 0.00139209415820368), new Complex(-0.00338681771197869, -0.00199947179859659), new Complex(0.0005539682761817, -0.00390806125614321), new Complex(0.000704334050527256, 0.000138070934135116), new Complex(0.00122285414994265, 0.00303028203809076), new Complex(-0.00400599100065399, 0.00405243779471913), new Complex(0.00453852521442594, 0.00178220122192587), new Complex(-0.00183277293558798, 0.000329932490603852), new Complex(0.000405735900950135, 0.000232212505134863), new Complex(-0.00162961884271087, -0.00245806715229757), new Complex(0.00101542396678373, -0.00240672510791282), new Complex(0.000807865559663047, -0.00277105695052612), new Complex(0.000280193818712259, 0.00103044792986472), new Complex(0.000241773273603273, -0.000268644065193887), new Complex(0.000170254845041402, 0.000600459480830868), new Complex(-0.00315188193051401, 0.00247815349928577), new Complex(-0.000831580299965149, 0.00182546103622038), new Complex(-0.000429780162789846, 0.00165197767062596), new Complex(-0.00398718249013946, -0.00114063151278471), new Complex(-0.00275548702100851, 8.85101167603341E-05), new Complex(0.00173688636906567, -0.00120262860819231), new Complex(-0.00252018270510057, -0.00270158827812291), new Complex(0.000659428146424917, -0.000417508007376321), new Complex(-0.00122204082876399, -0.00264156753906943), new Complex(0.00634624318288647, -0.000627333515400888), new Complex(-0.00232516118729665, -0.000547281667914918), new Complex(-0.00192517457940412, 0.00398169894104608), new Complex(-0.00707753302295894, -0.00238289260899819), new Complex(0.00163117277111283, 0.00295366505209105), new Complex(-0.00239328300398069, 0.00738918372877441), new Complex(-0.00425183016188416, 0.00173677331029285), new Complex(-0.0105267382274382, -0.00553147158604856), new Complex(0.00527956435690361, -0.00391220411642836), new Complex(-0.0179706997955439, 0.00083580198964689), new Complex(0.0131513759755183, -0.00631276408617254), new Complex(-0.0336850638721134, 0.00362031508662612), new Complex(-0.0160247086548414, -0.00276489753001741), new Complex(-0.0692963116251405, 0.00432862238985369), new Complex(0.0443408504210588, 0.0317426604739091), new Complex(-0.166663182078652, -0.0932029380339721), new Complex(-0.234998439006496, 0.257425888249004), new Complex(0.224125435320161, 0.245069972417877), new Complex(0.190369022934576, 0.0169775168553595), };

        private List<Complex[]> shape_list = new List<Complex[]>()
        {
            book,rotation_panel,door,right,left,reset,half,doubl
        };
        private List<String> shape_names = new List<String>()
        {
            "book","rotation_panel","door","right","left","reset","half","doubl"
        };

        public Form1()
        {
            InitializeComponent();

            var chartArea = chart1.ChartAreas["ChartArea1"];
            chartArea.AxisX.Minimum = 0;
            chartArea.AxisX.Maximum = 100;
            chartArea.AxisY.Minimum = 0;
            chartArea.AxisY.Maximum = 0.5;
            chartArea.AxisY.Interval = 0.05;
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            //PictureBoxのサイズに合わせて表示
            pictureBox1.SizeMode = PictureBoxSizeMode.StretchImage;
            pictureBox2.SizeMode = PictureBoxSizeMode.StretchImage;
        }


        private void button1_Click(object sender, EventArgs e)
        {
            //VideoCapture作成
            using (var capture = new VideoCapture())
            {
                //カメラの起動　
                capture.Open(0);
                string[] PortList = SerialPort.GetPortNames();
                Console.WriteLine(String.Join(",",PortList));
                var port = new SerialPort();
                try
                {
                    port.PortName = PortList[0];
                    port.Open();
                }
				catch
				{
                    port = null;
				}

                if (!capture.IsOpened())
                {
                    throw new Exception("capture initialization failed");
                }

                //画像取得用のMatを作成
                _flame = new Mat();
                var history = new List<Complex>();
                var framecount = 0;
                var Fps = 60;
                var err_minimum = 1000.0;
                var minimum_index = 0;

                while (true)
                {
                    try
                    {
                        capture.Read(_flame);
                        if (_flame.Empty())
                        {
                            Task.Delay(1);
                            break;
                        }

                        if (_flame.Size().Width > 0)
                        {
                            framecount++;
                            //PictureBoxに表示　MatをBitMapに変換
                            pictureBox1.Image = BitmapConverter.ToBitmap(_flame.Clone());
                            pictureBox1.Refresh();

                            var image = _flame.CvtColor(ColorConversionCodes.BGR2GRAY);
                            var points = new List<(int, int)>();
                            image = image.Threshold(150, 255,ThresholdTypes.Binary);
                            var moments = image.Moments();
                            if (moments.M00 == 0) continue;

                            pictureBox2.Image = BitmapConverter.ToBitmap(image);
                            var center = new Point(moments.M10 / moments.M00, moments.M01 / moments.M00);
                            history.Add(new Complex(_flame.Width - center.X, center.Y));
                            image = image.CvtColor(ColorConversionCodes.GRAY2RGB);
                            image.DrawMarker(center, new Scalar(0, 0, 255));

                            if (framecount % 3 == 0 && history.Count > Fps)
                            {
                                var moved_length = Moved_length(history.GetRange(history.Count-(Fps/3)-1,Fps/3).ToArray());
                                
                                if (moved_length > 20)
                                {
                                    var sample= Normalize(history.ToArray(), 30);
                                    Fourier.Forward(sample, FourierOptions.Default);
									for (int i = 0; i < shape_list.Count; i++)
									{
                                        var error = Calc_error(sample, shape_list[i]);
                                        if (error < err_minimum)
                                        {
                                            err_minimum = error;
                                            minimum_index = i;
                                        }
                                    }
                                    /*
                                    var series = chart1.Series["Series1"];
                                    series.Points.Add(error);
                                    if (series.Points.Count > 100)
                                    {
                                        series.Points.RemoveAt(0);
                                    }
                                    */
								}
								else{
                                    var temp = Moved_length(history.ToArray());
                                    if (temp > 300 && err_minimum < 0.3)
                                    {
                                        label1.Text += shape_names[minimum_index] + "\n";
                                        if(port != null)
                                        {
                                            if (shape_names[minimum_index] == "reset")
                                            {
                                                port.Write("c");
                                            }

                                            if (shape_names[minimum_index] == "door")
                                            {
                                                port.Write("o");
                                            }
										}

                                        minimum_index = 0;
                                        err_minimum = 10000.0;
									}
                                    history.Clear();
                                }

                            }

                        }

                        int key = Cv2.WaitKey();

                        if (this.IsDisposed)
                        {
                            break;
                        }
                    }

                    catch (Exception)
                    {
                        break;
                    }
                }

            }
        }
		private void button2_Click(object sender, EventArgs e)
		{
            label1.Text = "";
		}
	}
}